<!DOCTYPE html>
<html class="um-win">
	<head>
		<meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1">
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" href="../css/font-icons.css">
		<link rel="stylesheet" href="../css/iuapmobile.um.css">
		<script src="../js/jquery.min.js" ></script>
		<script src="../js/summer.js" ></script>
		<script src="../js/Frameworks/iuapmobile.frameworks.ui.js" ></script>	 
		<style>
			.um-content{
				background:#256FEA;
			}
			.login{
				background:#fff;
				padding:15px;
				border-radius:5px;
				padding:6%;
			}
			.login button.um-btn{
				border-radius:3px;
				padding:5px 12px;
				border-color:#009BF5;
				background:#009BF5;
			}
			.login p.title{
				color:#00B3ED;
			}
			.login p.user{
				color:#848484;
			}
			input.form-control{
				border:none;
				border-bottom:1px solid #e3e3e5;
				padding-left:0px;
			}
			input.form-control:focus{
				box-shadow:none;
			}
			.login .um-input-clear {
				color: #fff;
				background-color: #ddd;padding:4px;
			}
			.form-control:focus + .um-input-clear {
				color: #fff;
			}
			.um-input-clear.ti-eye.eye{
				color:#256FEA;
			}
		</style>     
	</head>
	<body>
		<div class="um-page um-win" id="index">
			<div id="main" class="um-content p15 um-box-center um-row">				
				<div class="login um-xs-10 um-sm-6 um-md-4 um-lg-3">				 
						<p class="title tc mb30 fb f24">WISE++</p> 
						<p class="user f14">用户名</p>	             		 
                             <div class="pr">
                             	<input type="text" class="form-control um-no-brs" id="username" value="admin" placeholder=" ">
                             	<span class="um-input-clear ti-close um-circle  f12"></span>
                             </div>				                        
		                 <p class="user f14 mt10">密码</p>
		                 <div class="pr">
		                 	<input type="password" class="form-control um-no-brs" id="password" value="yonyou1234" placeholder="">
		             		<span class="um-input-clear ti-eye um-circle  f12 "></span>
		                 </div>		             	
	                    <button id="login_btn" class="um-btn mt30">登  录</button>
	                    <p class="tr mt10 f12"><a href="">忘记密码？</a></p>   					              
				</div>				 
			 </div>		 
		</div>
		 <script>
        	$(function(){
        		$(".um-input-clear.ti-close").click(function() {
        		    $(this).prev("input").val("");
        		})
        		$(".um-input-clear.ti-eye").click(function() {
        		   var $pre_input=$(this).prev("input");
        		    ('password'==$pre_input.attr('type'))?$pre_input.attr('type','text'):$pre_input.attr('type','password');
        		    $(this).toggleClass('eye');  		    
        		})
        		var limitNum = 10;
                var offsetNum = 0;
                
        		 function refulshDate(){
                	var urlStr = "http://10.180.3.119:8080/dms.web/dmsMobile/customerManage/vehicle?dmsFuncId=302002&sort=VIN&order=asc"
					urlStr = urlStr + "&limit="+limitNum+"&offset="+offsetNum;
					var currentToken = summer.getStorage("currentToken_URL");
					
					if(null != currentToken){
						urlStr = urlStr + "&urlToken="+currentToken;
					}
					var cur_sessionId = summer.getStorage("cur_sessionId");
					
					if(null != cur_sessionId){
						urlStr = urlStr + "&JSESSIONID="+cur_sessionId;
					}
					
					var tenantId = summer.getStorage("tenantId");
					
					if(null != tenantId){
						urlStr = urlStr + "&tenantId="+tenantId;
					}
					alert("message_url"+urlStr);
					
					$.ajax({
						type: 'get',
						url: urlStr,
						dataType: 'json',
						contentType: "application/json ; charset=utf-8",
						success: function(data) {
							alert(data);
						},
						error: function(XMLHttpRequest, textStatus, errorThrown) {
							alert(XMLHttpRequest);
						}
					})
                }
        		
        		$("#login_btn").click(function(){
        			var username = $("#username").val();
        			var password = $("#password").val();
        			var urlStr = "http://10.180.3.119:8080/dms.web/dmsMobile/common/login?groupCode=GMS001&validate=&_=1496979336890"
        			if(null != username){
        				urlStr = urlStr + "&username="+username;
        			}else{
        				summer.toast({msg:"请录入用户名！",position:"middle"});
        				return false;
        			}
        			if(null != password){
        				urlStr = urlStr + "&password="+password;
        			}else{
        				summer.toast({msg:"请录入密码！",position:"middle"});
        				return false;
        			}
        		
        			summer.get(urlStr, {
					}, {
					  
					}, function(response) {
						var data = response.data;
						if(null != data){
							var dataJSON = $summer.strToJson(data)
							var sessionId = dataJSON.sessionId;
							var tenantId = dataJSON.tenantId;
							summer.setStorage("cur_sessionId", sessionId);
							summer.setStorage("tenantId", tenantId);
							
							//header
							var headers = response.headers;
							var headersStr = $summer.jsonToStr(headers);
							summer.setStorage("web_headers", headersStr);
							
							
							//refulshDate();
						
							/**/summer.openWin({
							    id: 'homePage',
							    url: 'html/home.html',
							    isKeep: false,
							    pageParam: {
							        name: 'test',
							        pwd:'testpwd'
							    }
							});
						}else{
							summer.toast({msg:"登录失败，请重新登录！",position:"middle"});
						}
					}, function(response) {
					    alert(response.error);
					});
        		
        			
        		})
        	})
        </script>
	</body>
</html>